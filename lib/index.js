var o=class s{token;refreshT;tokenT;refreshtoken;lastrefreshTime;lastAccessTime;constructor(t){this.token=s.createToken(),this.refreshtoken=s.createToken(),this.tokenT=t?.TokenTime||3600,this.refreshT=t?.RefreshDays||30,this.lastrefreshTime=Date.now(),this.lastAccessTime=Date.now()}newToken(t){let e=Math.floor(Math.random()*((t?this.refreshtoken.length:this.token.length)-10+1));return String(e).length<2&&(e=(e||1)*10),e>this.token.length-15&&(e=e-77),setTimeout(()=>{s.timeDiff(this.lastAccessTime).diffSeconds>this.tokenT&&this.resetAccessToken(),this.token=s.createToken()}),(t?this.refreshtoken:this.token).slice(e-10,e)+"@"+e}verifyToken(t,e){let[n,r]=t.split("@");return(e?this.refreshtoken:this.token).slice(Number(r)-10,Number(r))===n}verifyRefreshToken(t){return this.verifyToken(t,!0)}getRefreshToken(){return s.timeDiff(this.lastrefreshTime).day>this.refreshT&&this.resetRefreshToken(),this.newToken(!0)}resetAccessToken(){this.token=s.createToken(),this.lastAccessTime=Date.now()}resetRefreshToken(){this.refreshtoken=s.createToken(),this.lastrefreshTime=Date.now()}static timeDiff(t){let e=Math.floor(Math.abs(new Date(Date.now()).getTime()-new Date(t).getTime())/1e3);return{day:Math.floor(e/86400)%30,diffSeconds:e}}static createToken(){let t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",e=t.length,n=Math.max(Math.random()*1e3,99),r="";for(;r.length<n;){let i=Math.floor(Math.random()*e);r+=t.charAt(i)}return r}};export{o as SafeToken};
